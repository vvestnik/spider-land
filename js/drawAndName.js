////////////////////////////////////////////////////////////////////////////////
//  function that hides Enter your name window
////////////////////////////////////////////////////////////////////////////////
function hideName(e){
////////////////////////////////////////////////////////////////////////////////
//  do not propagate the click on the button to parents
////////////////////////////////////////////////////////////////////////////////
    e.stopPropagation();
////////////////////////////////////////////////////////////////////////////////
//  animate downslide of the window, wait, then remove the window
////////////////////////////////////////////////////////////////////////////////    
    let $gameArea = $('#field');
    let fieldHeight = parseInt($gameArea.css('height'));
    let waitForSlide = 0;
    $('#nameWindow').animate({
        top: fieldHeight + 'px'
    }, 1000);
    waitForSlide = setTimeout(removeName, 1100);
////////////////////////////////////////////////////////////////////////////////
//  help function for waiting animation to end
////////////////////////////////////////////////////////////////////////////////
    function removeName(){
        $('#nameWindow').remove();
        clearTimeout(waitForSlide);
        waitForSlide = 0;
    }
}
////////////////////////////////////////////////////////////////////////////////
//  function that draws a name of the player from virtual canvas to canvas in 
//  the menu
////////////////////////////////////////////////////////////////////////////////
function drawName(name){
////////////////////////////////////////////////////////////////////////////////
//  field container
////////////////////////////////////////////////////////////////////////////////
    let $gameArea = $('#field');
////////////////////////////////////////////////////////////////////////////////
//  game area dimensions
////////////////////////////////////////////////////////////////////////////////
    let fieldWidth = parseInt($gameArea.css('width'));
    let fieldHeight = parseInt($gameArea.css('height'));
    
    $('#field').append('<canvas id ="name" class ="menu"></canvas>');
    let canvasName = $('#name')[0];
    let drawData = drawWord(name);
    canvasName.height = 63;
    canvasName.width = drawData[0];
    $('#name').css({
        position: 'absolute',
        left: 0.5 * fieldWidth - 0.5 * parseInt($('#name').css('width')) + 'px',
        bottom: - parseInt($('#name').css('height')) + 'px'
    }).animate({
        left: 0.5 * fieldWidth - 0.5 * parseInt($('#name').css('width')) + 'px',
         top: 1.5 * (0.5 * fieldHeight - 0.5 * parseInt($('#name').css('height'))) + 'px'
    }, 1000);
    
    let ctxName = canvasName.getContext('2d');
    let image = drawData[1];
    ctxName.drawImage(image, 0, 0);

}

////////////////////////////////////////////////////////////////////////////////
//  function that draws a word to a virtual canvas
////////////////////////////////////////////////////////////////////////////////
function drawWord(word){
////////////////////////////////////////////////////////////////////////////////
//  split word to characters
////////////////////////////////////////////////////////////////////////////////
    let wordArray = String(word).split('');
    let canvas = $('<canvas></canvas>')[0];
    let charWidth = [];
////////////////////////////////////////////////////////////////////////////////
//  W and M have bigger width
////////////////////////////////////////////////////////////////////////////////
    for(let i = 0; i < wordArray.length; i++){
        if(wordArray[i] == 'M' || wordArray[i] == 'W'){
            charWidth[i] = 65;
        }
        else{
            charWidth[i] = 51;
        }
    }
////////////////////////////////////////////////////////////////////////////////
//  calculate each character's X position in the canvas
////////////////////////////////////////////////////////////////////////////////
    let charPos = [];
    for(let i = 0; i <= charWidth.length; i ++){
        if(i == 0){
            charPos[i] = 0;
        }
        else{
            charPos[i] = charPos[i-1] + charWidth[i-1] - 5;
        }
    }
////////////////////////////////////////////////////////////////////////////////
//  set canvas dimensions
////////////////////////////////////////////////////////////////////////////////
    let coWidth = charPos.pop() + 5;
    canvas.width = coWidth;
    canvas.height = 63;
////////////////////////////////////////////////////////////////////////////////
//  draw characters
////////////////////////////////////////////////////////////////////////////////
    let ctxName = canvas.getContext('2d');
    for(let i = 0; i < wordArray.length; i++){
        let image = charArray[wordArray[i]];

        ctxName.drawImage(image, charPos[i], 0);
    }
////////////////////////////////////////////////////////////////////////////////
//  return canvas width and image as canvas
////////////////////////////////////////////////////////////////////////////////
    return [coWidth, canvas];
}